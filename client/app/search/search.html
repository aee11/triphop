<div ng-include="'components/navbar/navbar.html'"></div>

<div layout="column" layout-padding layout-align="center">
  <form name="searchQuery" ng-submit="search()">

    
		
    <div class="container">
      <div class="row">
        <div class="col-xs-2">
          <label>Start: </label>
        </div>
        <div class="col-xs-4">
          <input type="text" class="form-control" placeholder="Start" ng-model="query.startLoc" typeahead="location as location.name for location in getLocation($viewValue)" typeahead-loading="loadingLocations" typeahead-template-url="typeaheadLocations.html" typeahead-wait-ms="300" class="form-control" />
        </div>
        <div class="col-xs-6">
            <p class="input-group">
              <input type="text" class="form-control" datepicker-popup="{{format}}" ng-model="query.startDate" is-open="opened" min-date="minDate" max-date="'2015-06-22'" datepicker-options="dateOptions" ng-required="true" close-text="Close" />
              <span class="input-group-btn">
                <button type="button" class="btn btn-default" ng-click="open($event)"><i class="glyphicon glyphicon-calendar"></i></button>
              </span>
            </p>
        </div>
      </div>
    </div>
		
		<!-- Add stop fields -->
		<div ng-repeat="stop in query.stops track by $index">
			<div class="container">
        <div class="row">
          <div class="col-xs-2">
  				  <label>Stop {{$index+1}}: <label>
          </div>
          <div class="col-xs-4">
  				  <input type="text" class="form-control" placeholder="Stop" ng-model="query.stops[$index]" typeahead="location as location.name for location in getLocation($viewValue)" typeahead-loading="loadingLocations" typeahead-template-url="typeaheadLocations.html" typeahead-wait-ms="300" />
          </div>
          <div class="col-xs-1"> 
            <button type="button" class="btn btn-danger" ng-click="removeStop([$index])" layout-align="center">x</button>
          </div>
          <div class="col-xs-2">
            <input type="text" class="form-control" placeholder="Duration" ng-model="query.durs[$index]"/>
          </div>
  			</div>
      </div>
		</div>
    <button type="button" class="btn btn-default" ng-click="addStop()">Add stop</button>
  </form>
</div>

<div layout="column" layout-align="center">
<button type="button" class="btn btn-default" ng-click="search()" layout-align="center">Search</button>
      
</div>

{{path}}

<div class="container">
  <div class="row">
    <ui-gmap-google-map center='map.center' zoom='map.zoom'>
      <ui-gmap-marker ng-repeat='(airport, data) in route.airportsOnRoute' idKey='airport' coords='{latitude: data.lat, longitude: data.lon}'></ui-gmap-marker>

        <ui-gmap-polyline 
          path="polylines.path" 
          stroke="polylines.stroke"
          visible='true'
          fit='true'
          icons='polylines.icons'
          draggable='false'
          clickable='false'>
        </ui-gmap-polyline>

    </ui-gmap-google-map>
  </div>
</div>

<script type="text/ng-template" id="typeaheadLocations.html">
  <a class='clearfix'>
      <span class='airport-location' ng-bind='match.model.name'></span> <span ng-if='!match.model.children' class='label label-info airport-code' ng-repeat='airport in match.model.airports' ng-bind='airport'></span>
      <span class='float-right' ng-bind='match.model.country'></span>
      <ul class='sublocation'>
        <li ng-repeat='subLocation in match.model.children'>
          <i class="glyphicon glyphicon-triangle-right"></i>
          {{ subLocation.name }} 
          <span class='label label-info airport-code'>{{ subLocation.airports[0] }}</span>
        </li>
      </ul>
      
  </a>
  <li class='divider autocomplete-divider'></li>
</script>

query = {{query | json}}






